<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Vita ‚Äî Simple Tracker</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    body { margin: 0; font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; }
  </style>
</head>
<body class="bg-slate-900 text-gray-200">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    function getTodayLocal() {
      const d = new Date();
      const y = d.getFullYear();
      const m = String(d.getMonth() + 1).padStart(2, '0');
      const day = String(d.getDate()).padStart(2, '0');
      return `${y}-${m}-${day}`;
    }

    function VitaApp() {
      const [view, setView] = useState('today');
      const today = getTodayLocal();
      const [data, setData] = useState(null);
      const [loading, setLoading] = useState(true);
      const [journal, setJournal] = useState('');
      const [water, setWater] = useState(0);
      const [saas, setSaas] = useState('');
      const [deepWork, setDeepWork] = useState('');
      const [talks, setTalks] = useState('');
      const [miles, setMiles] = useState('');
      const [weights, setWeights] = useState({});
      const [workout, setWorkout] = useState(null);
      const [history, setHistory] = useState([]);
      const [viewingDay, setViewingDay] = useState(null);
      const [showAllHistory, setShowAllHistory] = useState(false);
      const [nutritionData, setNutritionData] = useState({});
      const [showAddFood, setShowAddFood] = useState(false);
      const [selectedMeal, setSelectedMeal] = useState('breakfast');
      const [saveStatus, setSaveStatus] = useState('');
      const [isExisting, setIsExisting] = useState(false);

      const rotation = ['back-biceps', 'legs', 'chest-triceps', 'running'];

      const exercises = {
        'back-biceps': [
          ['Deadlifts 4x6', 'Bent Rows 4x8', 'Pull-ups 3x10', 'Barbell Curls 3x12', 'Hammer Curls 3x10'],
          ['T-Bar Rows 4x8', 'Lat Pulldowns 4x10', 'Cable Rows 3x12', 'Preacher Curls 3x12', 'Concentration Curls 3x10']
        ],
        'legs': [
          ['Squats 4x8', 'Romanian Deadlifts 4x10', 'Leg Press 3x12', 'Lunges 3x10', 'Calf Raises 4x15'],
          ['Front Squats 4x8', 'Bulgarian Splits 3x10', 'Leg Curls 4x12', 'Leg Extensions 3x12', 'Seated Calf 4x15']
        ],
        'chest-triceps': [
          ['Bench Press 4x8', 'Incline DB Press 4x10', 'Dips 3x12', 'Tricep Pushdowns 3x12', 'Overhead Ext 3x10'],
          ['Incline Bench 4x8', 'Flat DB Press 4x10', 'Cable Flyes 3x12', 'Close Grip Bench 3x10', 'Skull Crushers 3x12']
        ]
      };

      const tasks = {
        core: [
          { id: 'cold', t: 'Cold shower/exposure' },
          { id: 'workout', t: 'Lifted/Ran (workout completed)' },
          { id: 'sun', t: 'Morning sunlight 10+ min' },
          { id: 'sleep', t: '7-8hr sleep scheduled' },
          { id: 'priorities', t: 'Wrote down 3 priorities for today' },
          { id: 'deep', t: '2-3hr deep work (phone locked away)' },
          { id: 'progress', t: 'Moved the product forward (tangible progress)' },
          { id: 'read', t: 'Read for 30 minutes' },
          { id: 'connect', t: 'Had real conversation with someone important (non-work)' }
        ],
        lead: [
          { id: 'no', t: 'Said no to distraction' },
          { id: 'talk', t: 'Had hard conversation' },
          { id: 'own', t: 'Owned mistake no excuses' },
          { id: 'help', t: 'Helped someone' },
          { id: 'hard', t: 'Did hardest thing first' }
        ],
        comm: [
          { id: 'rec', t: 'Recorded 60s pitch' },
          { id: 'pause', t: 'Paused before responding' },
          { id: 'short', t: 'Rewrote 50% shorter' },
          { id: 'clear', t: 'Explained product clearly' }
        ]
      };

      const labels = { 'back-biceps': 'Back & Biceps', 'legs': 'Legs', 'chest-triceps': 'Chest & Triceps', 'running': 'Running' };

      function makeStorage() {
        if (window.storage && window.storage.get && window.storage.set && window.storage.list) {
          return window.storage;
        }
        return {
          get: async (key) => {
            const val = localStorage.getItem(key);
            return val ? { value: val } : null;
          },
          set: async (key, value) => {
            localStorage.setItem(key, value);
            return { key, value };
          },
          list: async (prefix) => {
            const keys = Object.keys(localStorage).filter(k => k.startsWith(prefix));
            return { keys };
          }
        };
      }

      useEffect(() => { loadData(); }, []);

      async function loadData() {
        setLoading(true);
        const storage = makeStorage();
        const initialData = { date: today, done: [], journal: '', water: 0, saas: '', deepWork: '', talks: '', miles: '', weights: {}, mood: null, workoutDone: false };
        try {
          // Load today's data
          try {
            const td = await storage.get(`day:${today}`);
            if (td && td.value) {
              const raw = (typeof td.value === 'string') ? td.value : '';
              const d = JSON.parse(raw || '{}');
              const merged = { ...initialData, ...d };
              const cleanData = JSON.parse(JSON.stringify(merged));
              setData(cleanData);
              setJournal(cleanData.journal || '');
              setWater(cleanData.water || 0);
              setSaas(cleanData.saas || '');
              setDeepWork(cleanData.deepWork || '');
              setTalks(cleanData.talks || '');
              setMiles(cleanData.miles || '');
              setWeights(cleanData.weights || {});
              setIsExisting(true);
            } else {
              setData(JSON.parse(JSON.stringify(initialData)));
              setJournal('');
              setWater(0);
              setSaas('');
              setDeepWork('');
              setTalks('');
              setMiles('');
              setWeights({});
              setIsExisting(false);
            }
          } catch (e) {
            console.error('Error loading today\'s data:', e);
            setData(JSON.parse(JSON.stringify(initialData)));
            setJournal('');
            setWater(0);
            setSaas('');
            setDeepWork('');
            setTalks('');
            setMiles('');
            setWeights({});
            setIsExisting(false);
          }

          // Load workout rotation
          try {
            const wr = await storage.get('workout-rotation');
            if (wr && wr.value) {
              const workoutData = JSON.parse(wr.value);
              setWorkout(workoutData);
            } else {
              setWorkout({ type: 'back-biceps', var: 0 });
            }
          } catch (e) {
            console.error('Error loading workout rotation:', e);
            setWorkout({ type: 'back-biceps', var: 0 });
          }

          // Load history
          await refreshHistory();
        } catch (e) {
          console.error('Critical error in loadData:', e);
          setData(JSON.parse(JSON.stringify(initialData)));
          setWorkout({ type: 'back-biceps', var: 0 });
          setHistory([]);
        } finally {
          setLoading(false);
        }
      }

      async function refreshHistory() {
        const storage = makeStorage();
        try {
          const res = await storage.list('day:');
          if (res?.keys) {
            const hist = await Promise.all(res.keys.map(async k => {
              try {
                const r = await storage.get(k);
                if (!r || !r.value) return null;
                const raw = (typeof r.value === 'string') ? r.value : '';
                const parsed = JSON.parse(raw || '{}');
                // Ensure we have all fields for proper display
                return {
                  date: parsed.date || k.replace('day:', ''),
                  done: parsed.done || [],
                  journal: parsed.journal || '',
                  water: parsed.water || 0,
                  saas: parsed.saas || '',
                  deepWork: parsed.deepWork || '',
                  talks: parsed.talks || '',
                  miles: parsed.miles || '',
                  weights: parsed.weights || {},
                  workoutDone: parsed.workoutDone || false,
                  workoutType: parsed.workoutType || null,
                  mood: parsed.mood || null
                };
              } catch (e) {
                console.error('Error loading history item:', k, e);
                return null;
              }
            }));
            const validHistory = hist.filter(Boolean);
            setHistory(validHistory.sort((a, b) => new Date(b.date) - new Date(a.date)));
          } else {
            setHistory([]);
          }
        } catch (e) {
          console.error('Error refreshing history:', e);
          setHistory([]);
        }
      }

      async function save(d) {
        try {
          setSaveStatus('Saving‚Ä¶');
          const storage = makeStorage();
          // Ensure we have a clean copy of the data
          const cleanData = JSON.parse(JSON.stringify(d));
          await storage.set(`day:${today}`, JSON.stringify(cleanData));
          setSaveStatus('Saved ‚úì');
          setTimeout(() => setSaveStatus(''), 2000);
          await refreshHistory();
          setIsExisting(true);
        } catch (e) {
          console.error('Save error', e);
          setSaveStatus('Save failed ‚ùå');
          setTimeout(() => setSaveStatus(''), 3000);
        }
      }

      async function startNewDay() {
        if (!window.confirm('Start a new day? This will snapshot and save the current entry, then reset Today to a fresh entry.')) return;
        const storage = makeStorage();
        try {
          if (data && data.date) {
            await storage.set(`day:${data.date}`, JSON.stringify(data));
          }
          const newData = { date: today, done: [], journal: '', water: 0, saas: '', deepWork: '', talks: '', miles: '', weights: {}, mood: null, workoutDone: false };
          setData(JSON.parse(JSON.stringify(newData)));
          setJournal(''); setWater(0); setSaas(''); setDeepWork(''); setTalks(''); setMiles(''); setWeights({});
          await storage.set(`day:${today}`, JSON.stringify(newData));
          await refreshHistory();
          setIsExisting(false);
          setSaveStatus('New day started');
          setTimeout(() => setSaveStatus(''), 2000);
        } catch (e) {
          console.error('New day error', e);
        }
      }

      async function completeWorkout() {
        const storage = makeStorage();

        // Validate that weights are entered for non-running workouts
        if (workout.type !== 'running') {
          const exercises = exercises[workout.type][workout.var];
          const missingWeights = exercises.filter(ex => !weights[ex]);
          if (missingWeights.length > 0) {
            alert(`Please enter weights for: ${missingWeights.join(', ')}`);
            return;
          }
        }

        const nd = {
          ...data,
          workoutType: workout.type,
          workoutDone: true,
          miles: (workout.type === 'running' ? miles : undefined),
          weights: (workout.type !== 'running' ? { ...weights } : undefined),
          workoutExercises: (workout.type !== 'running' ? exercises[workout.type][workout.var] : undefined),
          workoutDate: new Date().toISOString()
        };
        const cleanData = JSON.parse(JSON.stringify(nd));
        setData(cleanData);
        await save(cleanData);

        // Show success message
        setSaveStatus('Workout completed! üí™');
        setTimeout(() => setSaveStatus(''), 2000);

        // Update workout rotation
        const idx = rotation.indexOf(workout.type);
        const nextWorkout = { type: rotation[(idx + 1) % rotation.length], var: 0 };
        setWorkout(nextWorkout);
        setWeights({});
        setMiles('');

        // Save the workout rotation
        try {
          await storage.set('workout-rotation', JSON.stringify(nextWorkout));
        } catch (e) {
          console.error('Failed to save workout rotation', e);
        }
      }

      async function toggle(id) {
        if (!data) return;
        const done = data.done.includes(id) ? data.done.filter(x => x !== id) : [...data.done, id];
        const nd = { ...data, done };
        const cleanData = JSON.parse(JSON.stringify(nd));
        setData(cleanData);
        await save(cleanData);
      }

      async function updateWater(n) {
        const nw = Math.max(0, (water || 0) + n);
        setWater(nw);
        const nd = { ...data, water: nw };
        const cleanData = JSON.parse(JSON.stringify(nd));
        setData(cleanData);
        await save(cleanData);
      }

      function genNew() {
        if (!workout || workout.type === 'running') return;
        const vars = exercises[workout.type] || [];
        setWorkout({ ...workout, var: (workout.var + 1) % Math.max(1, vars.length) });
      }

      if (loading || !data || !workout) {
        return (
          <div className="flex items-center justify-center h-screen">
            <div className="text-xl text-gray-300">Loading‚Ä¶</div>
          </div>
        );
      }

      if (view === 'workouts') {
        const ex = workout.type === 'running' ? null : exercises[workout.type][workout.var];
        return (
          <div className="min-h-screen p-4">
            <div className="max-w-4xl mx-auto">
              <h1 className="text-4xl font-bold mb-4 text-center">Vita</h1>
              <div className="flex gap-2 justify-center mb-6">
                <button onClick={() => setView('today')} className="px-6 py-2 bg-slate-700 rounded-lg">Today</button>
                <button onClick={() => setView('progress')} className="px-6 py-2 bg-slate-700 rounded-lg">Progress</button>
                <button onClick={() => setView('workouts')} className="px-6 py-2 bg-amber-600 text-white rounded-lg">Workouts</button>
              </div>
              <div className="bg-slate-800 rounded-xl p-6 border border-slate-700 mb-6">
                <div className="flex justify-between items-center mb-4">
                  <div>
                    <h2 className="text-2xl font-bold">Today: {labels[workout.type]}</h2>
                    <p className="text-sm text-gray-400">Next: {labels[rotation[(rotation.indexOf(workout.type) + 1) % 4]]}</p>
                  </div>
                  {workout.type !== 'running' && <button onClick={genNew} className="px-4 py-2 bg-slate-700 rounded">New Exercises</button>}
                </div>
                {workout.type === 'running' ? (
                  <div className="space-y-4">
                    <input type="number" step="0.1" value={miles} onChange={(e) => setMiles(e.target.value)} placeholder="Miles run" className="w-full p-3 bg-slate-700 rounded text-white" />
                    <button onClick={completeWorkout} disabled={!miles || data.workoutDone} className="w-full py-3 bg-green-600 rounded font-semibold disabled:bg-slate-600">{data.workoutDone ? '‚úì Done' : 'Complete'}</button>
                  </div>
                ) : (
                  <div className="space-y-3">
                    {ex.map((e, i) => (
                      <div key={i} className={`bg-slate-700 rounded-lg p-4 ${data.workoutDone ? 'opacity-75' : ''}`}>
                        <div className="font-medium mb-2 flex items-center justify-between">
                          <span>{e}</span>
                          {data.workoutDone && weights[e] && <span className="text-green-400 text-sm">‚úì Saved</span>}
                        </div>
                        <input
                          type="number"
                          placeholder="Weight (lbs)"
                          value={weights[e] || ''}
                          onChange={(ev) => setWeights({...weights, [e]: ev.target.value})}
                          className={`w-full p-2 bg-slate-600 rounded text-sm text-white ${data.workoutDone ? 'cursor-not-allowed' : ''}`}
                          disabled={data.workoutDone}
                        />
                        {data.workoutDone && weights[e] && (
                          <p className="text-xs text-gray-400 mt-1">Previous: {weights[e]} lbs</p>
                        )}
                      </div>
                    ))}
                    <button onClick={completeWorkout} disabled={data.workoutDone} className="w-full py-3 bg-green-600 rounded font-semibold disabled:bg-slate-600">
                      {data.workoutDone ? '‚úì Workout Completed' : 'Complete Workout'}
                    </button>
                  </div>
                )}
              </div>
            </div>
          </div>
        );
      }

      if (view === 'affirmations') {
        // Personalized affirmations based on user's goals and progress
        const affirmations = {
          general: [
            "I am becoming the best version of myself every day",
            "I have the power to create the life I desire",
            "Every challenge I face is an opportunity to grow stronger",
            "I am worthy of success and happiness",
            "My potential is limitless and I unlock it daily",
            "I choose progress over perfection",
            "I am grateful for my journey and excited for what comes next",
            "I radiate confidence and positive energy",
            "I am capable of achieving extraordinary things",
            "Today, I choose to be unstoppable"
          ],
          productivity: [
            "I am focused, disciplined, and productive in all my endeavors",
            "Deep work is my superpower and I master it daily",
            "I complete important tasks with ease and efficiency",
            "My time is valuable and I use it wisely",
            "I set clear goals and achieve them consistently",
            "I am a master of my schedule and priorities",
            "Procrastination has no power over me",
            "I work with purpose and passion every day",
            "My productivity creates lasting impact",
            "I accomplish more than I thought possible"
          ],
          health: [
            "My body is strong, healthy, and full of energy",
            "I nourish my body with healthy choices",
            "Every workout brings me closer to my ideal self",
            "I am committed to my physical and mental wellbeing",
            "Rest and recovery are essential parts of my strength",
            "I treat my body with love and respect",
            "My health is my foundation for success",
            "I move my body with joy and purpose",
            "I am grateful for my body's incredible capabilities",
            "Healthy habits are my daily celebration of self-love"
          ],
          mindset: [
            "I think positively and attract positive outcomes",
            "Challenges are opportunities in disguise",
            "I learn and grow from every experience",
            "My mindset determines my reality",
            "I choose faith over fear in every situation",
            "I am resilient and bounce back stronger",
            "My thoughts create my reality",
            "I embrace change and adapt with grace",
            "I am the author of my own story",
            "Every day brings new possibilities and growth"
          ],
          leadership: [
            "I lead with integrity and inspire others",
            "My hard conversations create meaningful change",
            "I own my mistakes and learn from them",
            "I help others grow and succeed",
            "I lead by example in all I do",
            "My leadership creates positive impact",
            "I communicate clearly and effectively",
            "I build strong relationships and trust",
            "I take initiative and responsibility",
            "I am a force for positive change"
          ]
        };

        // Get today's affirmation based on user's recent focus
        const getTodaysAffirmation = () => {
          const today = new Date();
          const seed = today.getFullYear() * 10000 + (today.getMonth() + 1) * 100 + today.getDate();

          // Check recent activity to personalize
          const recentTasks = history.slice(0, 3).flatMap(d => d.done || []);
          const hasProductivity = recentTasks.some(t => ['deep', 'progress', 'priorities'].includes(t));
          const hasLeadership = recentTasks.some(t => ['hard', 'own', 'help'].includes(t));
          const hasWorkout = history.slice(0, 3).some(d => d.workoutDone);

          let category = 'general';
          if (hasProductivity && hasLeadership) category = 'leadership';
          else if (hasProductivity) category = 'productivity';
          else if (hasWorkout) category = 'health';
          else if (Math.random() > 0.7) category = 'mindset';

          const categoryAffirmations = affirmations[category];
          return categoryAffirmations[seed % categoryAffirmations.length];
        };

        const todaysAffirmation = getTodaysAffirmation();
        const affirmationCategory = todaysAffirmation.includes('productivity') || todaysAffirmation.includes('work') ? 'productivity' :
                                   todaysAffirmation.includes('health') || todaysAffirmation.includes('body') ? 'health' :
                                   todaysAffirmation.includes('leadership') || todaysAffirmation.includes('lead') ? 'leadership' :
                                   todaysAffirmation.includes('mindset') || todaysAffirmation.includes('think') ? 'mindset' : 'general';

        return (
          <div className="min-h-screen p-4">
            <div className="max-w-4xl mx-auto">
              <h1 className="text-4xl font-bold mb-4 text-center">Vita</h1>
              <div className="flex gap-2 justify-center mb-6 flex-wrap">
                <button onClick={() => setView('today')} className="px-4 py-2 bg-slate-700 text-gray-300 rounded-lg text-sm">Today</button>
                <button onClick={() => setView('progress')} className="px-4 py-2 bg-slate-700 text-gray-300 rounded-lg text-sm">Progress</button>
                <button onClick={() => setView('workouts')} className="px-4 py-2 bg-slate-700 text-gray-300 rounded-lg text-sm">Workouts</button>
                <button onClick={() => setView('affirmations')} className="px-4 py-2 bg-amber-600 text-white rounded-lg text-sm">Affirmations</button>
              </div>

              {/* Today's Main Affirmation */}
              <div className="bg-slate-800 rounded-xl p-8 mb-6 border border-slate-700 text-center">
                <div className="mb-4">
                  <span className={`px-3 py-1 rounded-full text-xs font-medium ${
                    affirmationCategory === 'productivity' ? 'bg-blue-600' :
                    affirmationCategory === 'health' ? 'bg-green-600' :
                    affirmationCategory === 'leadership' ? 'bg-purple-600' :
                    affirmationCategory === 'mindset' ? 'bg-yellow-600' :
                    'bg-amber-600'
                  } text-white`}>
                    {affirmationCategory.charAt(0).toUpperCase() + affirmationCategory.slice(1)}
                  </span>
                </div>
                <h2 className="text-2xl md:text-3xl font-bold text-white mb-4 leading-relaxed">
                  "{todaysAffirmation}"
                </h2>
                <p className="text-gray-400 text-sm">Your affirmation for {new Date().toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' })}</p>
              </div>

              {/* Quick Affirmation Categories */}
              <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                <div className="bg-slate-800 rounded-xl p-6 border border-slate-700">
                  <h3 className="text-lg font-bold mb-3 text-blue-400">üíº Productivity</h3>
                  <p className="text-sm text-gray-300 mb-3">{affirmations.productivity[Math.floor(Math.random() * affirmations.productivity.length)]}</p>
                  <button className="w-full py-2 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700 transition-colors">
                    Get New One
                  </button>
                </div>

                <div className="bg-slate-800 rounded-xl p-6 border border-slate-700">
                  <h3 className="text-lg font-bold mb-3 text-green-400">üí™ Health & Fitness</h3>
                  <p className="text-sm text-gray-300 mb-3">{affirmations.health[Math.floor(Math.random() * affirmations.health.length)]}</p>
                  <button className="w-full py-2 bg-green-600 text-white rounded-lg text-sm hover:bg-green-700 transition-colors">
                    Get New One
                  </button>
                </div>

                <div className="bg-slate-800 rounded-xl p-6 border border-slate-700">
                  <h3 className="text-lg font-bold mb-3 text-purple-400">üëë Leadership</h3>
                  <p className="text-sm text-gray-300 mb-3">{affirmations.leadership[Math.floor(Math.random() * affirmations.leadership.length)]}</p>
                  <button className="w-full py-2 bg-purple-600 text-white rounded-lg text-sm hover:bg-purple-700 transition-colors">
                    Get New One
                  </button>
                </div>

                <div className="bg-slate-800 rounded-xl p-6 border border-slate-700">
                  <h3 className="text-lg font-bold mb-3 text-yellow-400">üß† Mindset</h3>
                  <p className="text-sm text-gray-300 mb-3">{affirmations.mindset[Math.floor(Math.random() * affirmations.mindset.length)]}</p>
                  <button className="w-full py-2 bg-yellow-600 text-white rounded-lg text-sm hover:bg-yellow-700 transition-colors">
                    Get New One
                  </button>
                </div>
              </div>

              {/* Inspiration Section */}
              <div className="bg-slate-800 rounded-xl p-6 border border-slate-700">
                <h3 className="text-lg font-bold mb-3">üí° Daily Inspiration</h3>
                <div className="space-y-3 text-sm text-gray-300">
                  <p><strong>Remember:</strong> Every expert was once a beginner. Every champion was once afraid to start.</p>
                  <p><strong>Action:</strong> The bridge between your goals and accomplishment is your daily actions.</p>
                  <p><strong>Growth:</strong> You're not competing with anyone else. You're competing with who you were yesterday.</p>
                  <p><strong>Resilience:</strong> The only way to fail is to stop trying. Every setback is a setup for a comeback.</p>
                </div>
              </div>
            </div>
          </div>
        );
      }

      if (view === 'coach') {
        // Calculate streaks and insights
        const calculateStreaks = () => {
          const streaks = {
            current: 0,
            longest: 0,
            workoutStreak: 0,
            longestWorkout: 0
          };

          // Task completion streak
          for (let i = 0; i < history.length; i++) {
            if (history[i].done && history[i].done.length > 0) {
              streaks.current++;
            } else {
              streaks.longest = Math.max(streaks.longest, streaks.current);
              streaks.current = 0;
            }
          }
          streaks.longest = Math.max(streaks.longest, streaks.current);

          // Workout streak
          for (let i = 0; i < history.length; i++) {
            if (history[i].workoutDone) {
              streaks.workoutStreak++;
            } else {
              streaks.longestWorkout = Math.max(streaks.longestWorkout, streaks.workoutStreak);
              streaks.workoutStreak = 0;
            }
          }
          streaks.longestWorkout = Math.max(streaks.longestWorkout, streaks.workoutStreak);

          return streaks;
        };

        const streaks = calculateStreaks();
        const todayTasks = data.done ? data.done.length : 0;
        const avgTasks = history.length > 0 ? Math.round((history.reduce((s, d) => s + (d.done ? d.done.length : 0), 0) / history.length) * 10) / 10 : 0;

        // Generate personalized coaching message
        const getCoachingMessage = () => {
          const messages = {
            excellent: [
              "üöÄ INCREDIBLE! You're crushing it! Keep this momentum going!",
              "üí™ You're in BEAST MODE! This level of consistency is rare and valuable.",
              "üåü You're not just participating, you're DOMINATING your growth journey!",
              "üèÜ LEGENDARY performance! You're setting the standard for excellence."
            ],
            great: [
              "üî• Great work! You're building habits that will change your life.",
              "üí™ Solid progress! Consistency like yours creates extraordinary results.",
              "üéØ You're on fire! Keep channeling this energy into your goals.",
              "‚≠ê Excellent momentum! You're becoming the person you want to be."
            ],
            good: [
              "üëç Good job! Every step forward counts. Keep building these habits.",
              "üí™ Steady progress! Small, consistent actions create big changes.",
              "üéØ You're moving in the right direction. Stay focused on your goals.",
              "‚≠ê Keep it up! You're developing habits that will serve you for life."
            ],
            needsImprovement: [
              "üí™ Let's get back on track! Remember why you started this journey.",
              "üéØ Every champion has off days. Today is your chance to get back to winning.",
              "üî• Your future self is counting on you. Let's make today count!",
              "üí™ You've got this! One strong day can restart your momentum."
            ]
          };

          if (streaks.current >= 7) return messages.excellent[Math.floor(Math.random() * messages.excellent.length)];
          if (streaks.current >= 3) return messages.great[Math.floor(Math.random() * messages.great.length)];
          if (todayTasks > 0) return messages.good[Math.floor(Math.random() * messages.good.length)];
          return messages.needsImprovement[Math.floor(Math.random() * messages.needsImprovement.length)];
        };

        const coachingMessage = getCoachingMessage();

        // Extended habit tracking beyond core tasks
        const extendedHabits = [
          { id: 'reading', name: 'Read for 30+ minutes', category: 'learning', streak: 0 },
          { id: 'meditation', name: 'Meditate or mindfulness', category: 'mindfulness', streak: 0 },
          { id: 'networking', name: 'Connect with someone meaningful', category: 'social', streak: 0 },
          { id: 'learning', name: 'Learn something new (skill/course)', category: 'growth', streak: 0 },
          { id: 'gratitude', name: 'Write 3 things grateful for', category: 'mindfulness', streak: 0 },
          { id: 'planning', name: 'Review and plan tomorrow', category: 'productivity', streak: 0 }
        ];

        return (
          <div className="min-h-screen p-4">
            <div className="max-w-4xl mx-auto">
              <h1 className="text-4xl font-bold mb-4 text-center">Vita</h1>
              <div className="flex gap-2 justify-center mb-6 flex-wrap">
                <button onClick={() => setView('today')} className="px-3 py-2 bg-slate-700 text-gray-300 rounded-lg text-xs">Today</button>
                <button onClick={() => setView('progress')} className="px-3 py-2 bg-slate-700 text-gray-300 rounded-lg text-xs">Progress</button>
                <button onClick={() => setView('workouts')} className="px-3 py-2 bg-slate-700 text-gray-300 rounded-lg text-xs">Workouts</button>
                <button onClick={() => setView('affirmations')} className="px-3 py-2 bg-slate-700 text-gray-300 rounded-lg text-xs">Affirmations</button>
                <button onClick={() => setView('coach')} className="px-3 py-2 bg-amber-600 text-white rounded-lg text-xs">Coach</button>
              </div>

              {/* Personalized Coaching Message */}
              <div className="bg-slate-800 rounded-xl p-6 mb-6 border border-slate-700">
                <h2 className="text-xl font-bold mb-4 text-center text-amber-400">üèÜ Your Accountability Coach</h2>
                <div className="text-center">
                  <p className="text-lg text-white mb-4 leading-relaxed">{coachingMessage}</p>
                  <div className="flex justify-center gap-4 text-sm">
                    <div className="bg-slate-700 px-3 py-2 rounded">
                      <span className="text-gray-400">Current Streak:</span>
                      <span className="text-amber-400 font-bold ml-1">{streaks.current} days</span>
                    </div>
                    <div className="bg-slate-700 px-3 py-2 rounded">
                      <span className="text-gray-400">Best Streak:</span>
                      <span className="text-green-400 font-bold ml-1">{streaks.longest} days</span>
                    </div>
                  </div>
                </div>
              </div>

              {/* Today's Performance */}
              <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                <div className="bg-slate-800 rounded-xl p-6 border border-slate-700 text-center">
                  <h3 className="text-sm font-bold text-gray-400 mb-2">Today's Tasks</h3>
                  <p className="text-3xl font-bold text-amber-400">{todayTasks}/18</p>
                  <p className="text-xs text-gray-500">completed</p>
                </div>
                <div className="bg-slate-800 rounded-xl p-6 border border-slate-700 text-center">
                  <h3 className="text-sm font-bold text-gray-400 mb-2">Average Tasks</h3>
                  <p className="text-3xl font-bold text-blue-400">{avgTasks}/18</p>
                  <p className="text-xs text-gray-500">per day</p>
                </div>
                <div className="bg-slate-800 rounded-xl p-6 border border-slate-700 text-center">
                  <h3 className="text-sm font-bold text-gray-400 mb-2">Workout Streak</h3>
                  <p className="text-3xl font-bold text-green-400">{streaks.workoutStreak}</p>
                  <p className="text-xs text-gray-500">days</p>
                </div>
              </div>

              {/* Extended Habit Tracking */}
              <div className="bg-slate-800 rounded-xl p-6 mb-6 border border-slate-700">
                <h3 className="text-lg font-bold mb-4">üéØ Extended Habit Tracking</h3>
                <p className="text-sm text-gray-400 mb-4">Track additional habits beyond your core tasks for comprehensive personal development.</p>
                <div className="space-y-3">
                  {extendedHabits.map(habit => (
                    <div key={habit.id} className="bg-slate-700 rounded-lg p-4">
                      <div className="flex items-center justify-between mb-2">
                        <span className="font-medium">{habit.name}</span>
                        <span className={`px-2 py-1 rounded text-xs ${
                          habit.category === 'learning' ? 'bg-blue-600' :
                          habit.category === 'mindfulness' ? 'bg-purple-600' :
                          habit.category === 'social' ? 'bg-green-600' :
                          habit.category === 'growth' ? 'bg-yellow-600' :
                          'bg-gray-600'
                        } text-white`}>
                          {habit.category}
                        </span>
                      </div>
                      <div className="flex gap-2">
                        <button className="flex-1 py-2 bg-slate-600 text-white rounded text-sm hover:bg-slate-500">
                          Track Today
                        </button>
                        <div className="px-3 py-2 bg-slate-600 rounded text-sm text-gray-300">
                          Streak: 0 days
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              </div>

              {/* Progress Insights */}
              <div className="bg-slate-800 rounded-xl p-6 border border-slate-700">
                <h3 className="text-lg font-bold mb-4">üìä Progress Insights</h3>
                <div className="space-y-4">
                  <div className="flex items-center justify-between p-3 bg-slate-700 rounded">
                    <span>Weekly Goal Progress</span>
                    <span className="text-amber-400 font-bold">
                      {history.slice(0, 7).filter(d => d.done && d.done.length > 0).length}/7 days
                    </span>
                  </div>
                  <div className="flex items-center justify-between p-3 bg-slate-700 rounded">
                    <span>Consistency Rating</span>
                    <span className={`font-bold ${
                      streaks.current >= 7 ? 'text-green-400' :
                      streaks.current >= 3 ? 'text-yellow-400' :
                      'text-red-400'
                    }`}>
                      {streaks.current >= 7 ? 'Excellent' : streaks.current >= 3 ? 'Good' : 'Needs Focus'}
                    </span>
                  </div>
                  <div className="flex items-center justify-between p-3 bg-slate-700 rounded">
                    <span>Next Milestone</span>
                    <span className="text-blue-400">
                      {streaks.longest + 1} day streak
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        );
      }

      if (view === 'books') {
        // Curated book database for self-improvement and entrepreneurship
        const bookDatabase = {
          productivity: [
            {
              title: "Deep Work",
              author: "Cal Newport",
              summary: "In an age of constant distraction, Cal Newport argues that the ability to perform deep work‚Äîfocused, cognitively demanding tasks‚Äîis becoming increasingly rare and valuable. Newport explores the concept of deep work versus shallow work, showing how deep work leads to higher quality output and greater satisfaction. He provides practical strategies for cultivating deep work habits, including scheduling rituals, creating the right environment, and embracing boredom. The book challenges the notion that connectivity and multitasking are virtues, instead advocating for deliberate disconnection to achieve meaningful results.",
              keyInsights: [
                "Deep work is the ability to focus without distraction on cognitively demanding tasks",
                "Schedule deep work sessions and protect them fiercely",
                "Minimize shallow work that doesn't create value",
                "Train your concentration through deliberate practice",
                "Embrace boredom to build mental resilience",
                "Quit social media if it hinders your deep work"
              ],
              whyRead: "Master the skill of focused, distraction-free work in our hyper-connected world"
            },
            {
              title: "Atomic Habits",
              author: "James Clear",
              summary: "James Clear reveals how small changes can create remarkable results through the power of habit compounding. Drawing on scientific research, Clear explains the psychology behind habit formation and provides a practical framework for building good habits and breaking bad ones. He introduces the Four Laws of Behavior Change: make it obvious, attractive, easy, and satisfying. The book emphasizes the importance of identity-based habits, environmental design, and the 'never miss twice' rule for maintaining consistency. Clear shows how understanding the science of small habits can transform your life in profound ways.",
              keyInsights: [
                "Small habits compound into remarkable results over time",
                "Focus on systems rather than goals for sustainable change",
                "Make habits attractive, easy, and satisfying",
                "Track your habits and never miss twice in a row",
                "Design your environment to support good habits",
                "Focus on identity change rather than outcome goals"
              ],
              whyRead: "Learn the science of habit formation and transformation"
            },
            {
              title: "Getting Things Done",
              author: "David Allen",
              summary: "David Allen's groundbreaking productivity methodology provides a complete system for organizing your life and work. The GTD method is built around the principle that your mind is for having ideas, not storing them. Allen teaches a five-step process: Capture, Clarify, Organize, Reflect, and Engage. He emphasizes the importance of collecting all your commitments into a trusted external system, processing them into actionable items, and maintaining regular reviews to keep everything current. The book addresses the psychology of productivity, showing how proper organization eliminates mental clutter and frees your mind for creative thinking.",
              keyInsights: [
                "Capture everything that requires attention into a trusted system",
                "Clarify what each item means and what action is required",
                "Organize reminders and information in the right categories",
                "Reflect regularly and keep your system current",
                "Your mind is for having ideas, not storing them",
                "Use the two-minute rule for quick tasks"
              ],
              whyRead: "Build a productivity system that eliminates overwhelm and maximizes focus"
            }
          ],
          mindset: [
            {
              title: "Mindset",
              author: "Carol Dweck",
              summary: "Carol Dweck's groundbreaking research reveals that our beliefs about intelligence and ability profoundly impact our success. She identifies two mindsets: fixed mindset (believing abilities are innate and unchangeable) and growth mindset (believing abilities can be developed through effort and learning). Dweck shows how these mindsets affect motivation, resilience, and achievement in school, work, and relationships. The book provides practical strategies for cultivating a growth mindset, including praising effort rather than intelligence, embracing challenges, and learning from criticism. Dweck demonstrates that changing your mindset can transform your life and help you reach your full potential.",
              keyInsights: [
                "Growth mindset believes abilities can be developed through dedication",
                "Fixed mindset avoids challenges and gives up easily",
                "Embrace challenges as opportunities to grow",
                "Learn from criticism and find lessons in setbacks",
                "Praise effort and process, not just outcomes",
                "View failures as learning opportunities"
              ],
              whyRead: "Discover how your mindset shapes your success and happiness"
            },
            {
              title: "The Power of Now",
              author: "Eckhart Tolle",
              summary: "Eckhart Tolle presents a revolutionary approach to spirituality and self-awareness that transcends traditional religious boundaries. He argues that true enlightenment comes from living in the present moment rather than being trapped in thoughts about the past or future. Tolle explains how the ego creates suffering through attachment, resistance, and identification with the mind. He provides practical exercises for becoming present, observing thoughts without judgment, and finding peace in everyday activities. The book challenges readers to question their relationship with time and discover the eternal nature of consciousness that exists beyond the thinking mind.",
              keyInsights: [
                "The present moment is all we ever have",
                "Your mind creates suffering through attachment to past/future",
                "Accept what is without resistance",
                "Find peace through presence and awareness",
                "Observe your thoughts without judgment",
                "The ego thrives on drama and identification"
              ],
              whyRead: "Learn to live in the present and find inner peace"
            }
          ],
          leadership: [
            {
              title: "The 7 Habits of Highly Effective People",
              author: "Stephen Covey",
              summary: "Stephen Covey's timeless classic presents seven habits that form the foundation of personal and professional effectiveness. Moving beyond quick-fix solutions, Covey provides a principle-centered approach to solving personal and professional problems. The habits are organized into three categories: private victory (habits 1-3), public victory (habits 4-6), and renewal (habit 7). Covey emphasizes that true change comes from within, starting with character development and moving outward to influence others. He illustrates how these habits create a framework for long-term success in all areas of life, from career to relationships to personal growth.",
              keyInsights: [
                "Be proactive - take responsibility for your life",
                "Begin with the end in mind - define your mission",
                "Put first things first - prioritize important over urgent",
                "Seek win-win solutions in relationships",
                "Seek first to understand, then to be understood",
                "Synergize - create better solutions through teamwork",
                "Sharpen the saw - renew yourself regularly"
              ],
              whyRead: "Master the fundamental principles of personal and professional effectiveness"
            },
            {
              title: "Dare to Lead",
              author: "Bren√© Brown",
              summary: "Bren√© Brown explores what it takes to be a courageous leader in an increasingly complex world. Drawing on extensive research, Brown identifies four skill sets that define daring leadership: rumbling with vulnerability, living into our values, braving trust, and learning to rise. She challenges the myth that vulnerability is weakness, instead showing how it builds connection and innovation. Brown provides practical tools for having difficult conversations, embracing discomfort, and creating cultures of belonging and innovation. The book combines research insights with real-world examples, showing how courageous leadership can transform organizations and communities.",
              keyInsights: [
                "Vulnerability is the birthplace of innovation and change",
                "Courage is contagious - model the behavior you seek",
                "Lean into discomfort and have tough conversations",
                "Build trust through reliability, accountability, and compassion",
                "Rumple with vulnerability instead of avoiding it",
                "Practice values-based leadership"
              ],
              whyRead: "Learn to lead with courage, compassion, and connection"
            }
          ],
          entrepreneurship: [
            {
              title: "The Lean Startup",
              author: "Eric Ries",
              summary: "Eric Ries revolutionizes entrepreneurship with the Lean Startup methodology, showing how to build successful businesses in an uncertain world. Drawing from his own experiences, Ries introduces the Build-Measure-Learn feedback loop as the foundation for innovation. He explains how to validate business hypotheses through minimum viable products, split testing, and actionable metrics. The book emphasizes the importance of learning over planning, showing how successful entrepreneurs use scientific methods to reduce risk and increase success rates. Ries provides practical tools for innovation accounting, pivot strategies, and sustainable growth in any business context.",
              keyInsights: [
                "Build-Measure-Learn feedback loop drives innovation",
                "Validated learning comes from running experiments",
                "Pivot when assumptions prove wrong",
                "Minimum Viable Product tests fundamental business hypotheses",
                "Use actionable metrics over vanity metrics",
                "Innovation requires discipline and focus"
              ],
              whyRead: "Master the methodology for building successful businesses"
            },
            {
              title: "Zero to One",
              author: "Peter Thiel",
              summary: "Peter Thiel challenges conventional wisdom about innovation and entrepreneurship, arguing that true progress comes from creating something fundamentally new rather than improving existing products. Thiel examines the patterns of successful companies like PayPal, LinkedIn, and SpaceX, identifying key principles for building enduring businesses. He explores the importance of monopoly creation, the power of secrets, and the role of timing in innovation. The book provides contrarian insights about competition, globalization, and the future of technology. Thiel combines philosophical depth with practical business advice, showing entrepreneurs how to create transformative companies that change the world.",
              keyInsights: [
                "Create monopoly by doing something others cannot",
                "Focus on technology and timing for competitive advantage",
                "Sales and distribution are often more important than product",
                "Build enduring companies, not just successful ones",
                "Competition is for losers - seek monopoly",
                "The future belongs to those who create it"
              ],
              whyRead: "Learn how to build the future and create lasting value"
            }
          ],
          health: [
            {
              title: "Why We Sleep",
              author: "Matthew Walker",
              summary: "Neuroscientist Matthew Walker presents a comprehensive exploration of sleep's transformative power for health, performance, and longevity. Drawing on decades of research, Walker explains how sleep affects every aspect of human functioning, from learning and memory to immune function and emotional regulation. He reveals the devastating consequences of sleep deprivation, showing how even small sleep deficits accumulate into serious health risks. The book provides practical strategies for optimizing sleep, including maintaining consistent sleep schedules, creating ideal sleep environments, and understanding the different stages of sleep. Walker makes a compelling case that sleep is not a luxury but an essential pillar of health and success.",
              keyInsights: [
                "Sleep is essential for learning, memory, and emotional regulation",
                "Most adults need 7-9 hours of quality sleep",
                "Poor sleep increases risk of disease and early death",
                "Consistent sleep schedule is more important than sleep duration",
                "Sleep deprivation impairs decision-making and creativity",
                "Dreaming plays crucial role in emotional processing"
              ],
              whyRead: "Understand the transformative power of sleep for health and performance"
            },
            {
              title: "How Not to Die",
              author: "Michael Greger",
              summary: "Dr. Michael Greger presents a comprehensive guide to preventing and reversing chronic diseases through evidence-based nutrition. Drawing on thousands of scientific studies, Greger identifies the most effective dietary interventions for preventing heart disease, cancer, diabetes, and other common illnesses. He introduces the 'Daily Dozen' - twelve categories of healthy foods that provide optimal nutrition. The book challenges conventional dietary wisdom, showing how plant-based eating can prevent and even reverse chronic diseases. Greger provides practical, actionable advice backed by rigorous scientific evidence, making complex nutritional science accessible to everyone.",
              keyInsights: [
                "Plant-based diets prevent and reverse chronic diseases",
                "Daily dozen: beans, berries, greens, and other protective foods",
                "Processed meats and added sugars are the biggest dietary risks",
                "Nutrition can prevent 80% of heart disease and cancers",
                "Whole foods provide synergistic health benefits",
                "Small dietary changes can have major health impacts"
              ],
              whyRead: "Discover evidence-based nutrition for longevity and disease prevention"
            }
          ]
        };

        // Get today's book recommendation
        const getTodaysBook = () => {
          const today = new Date();
          const categories = Object.keys(bookDatabase);
          const categoryIndex = today.getDay() % categories.length; // Rotate by day of week
          const category = categories[categoryIndex];
          const books = bookDatabase[category];
          const bookIndex = Math.floor(today.getDate() / 7) % books.length; // Rotate weekly
          return { ...books[bookIndex], category };
        };

        const todaysBook = getTodaysBook();

        return (
          <div className="min-h-screen p-4">
            <div className="max-w-4xl mx-auto">
              <h1 className="text-4xl font-bold mb-4 text-center">Vita</h1>
              <div className="flex gap-1 justify-center mb-6 flex-wrap">
                <button onClick={() => setView('today')} className="px-2 py-2 bg-slate-700 text-gray-300 rounded text-xs">Today</button>
                <button onClick={() => setView('progress')} className="px-2 py-2 bg-slate-700 text-gray-300 rounded text-xs">Progress</button>
                <button onClick={() => setView('workouts')} className="px-2 py-2 bg-slate-700 text-gray-300 rounded text-xs">Workouts</button>
                <button onClick={() => setView('affirmations')} className="px-2 py-2 bg-slate-700 text-gray-300 rounded text-xs">Affirmations</button>
                <button onClick={() => setView('coach')} className="px-2 py-2 bg-slate-700 text-gray-300 rounded text-xs">Coach</button>
                <button onClick={() => setView('books')} className="px-2 py-2 bg-amber-600 text-white rounded text-xs">Books</button>
              </div>

              {/* Today's Book Recommendation */}
              <div className="bg-slate-800 rounded-xl p-6 mb-6 border border-slate-700">
                <div className="flex items-start justify-between mb-4">
                  <div>
                    <span className={`px-3 py-1 rounded-full text-xs font-medium mb-2 inline-block ${
                      todaysBook.category === 'productivity' ? 'bg-blue-600' :
                      todaysBook.category === 'mindset' ? 'bg-purple-600' :
                      todaysBook.category === 'leadership' ? 'bg-green-600' :
                      todaysBook.category === 'entrepreneurship' ? 'bg-yellow-600' :
                      'bg-red-600'
                    } text-white`}>
                      {todaysBook.category.charAt(0).toUpperCase() + todaysBook.category.slice(1)}
                    </span>
                    <h2 className="text-2xl font-bold text-white">{todaysBook.title}</h2>
                    <p className="text-gray-400">by {todaysBook.author}</p>
                  </div>
                  <div className="text-right">
                    <p className="text-sm text-gray-500">Today's Pick</p>
                    <p className="text-xs text-gray-600">{new Date().toLocaleDateString()}</p>
                  </div>
                </div>

                <div className="mb-4">
                  <h3 className="font-bold text-amber-400 mb-2">Why You Should Read This:</h3>
                  <p className="text-gray-300 text-sm">{todaysBook.whyRead}</p>
                </div>

                <div>
                  <h3 className="font-bold text-amber-400 mb-3">Book Summary:</h3>
                  <p className="text-sm text-gray-300 mb-4 leading-relaxed">{todaysBook.summary}</p>

                  <h3 className="font-bold text-amber-400 mb-3">Key Takeaways:</h3>
                  <ul className="space-y-2">
                    {todaysBook.keyInsights.map((insight, index) => (
                      <li key={index} className="flex items-start text-sm text-gray-300">
                        <span className="text-amber-400 mr-2 mt-1">‚Ä¢</span>
                        <span>{insight}</span>
                      </li>
                    ))}
                  </ul>
                </div>
              </div>

              {/* Book Categories */}
              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
                {Object.entries(bookDatabase).map(([category, books]) => (
                  <div key={category} className="bg-slate-800 rounded-xl p-4 border border-slate-700">
                    <h3 className="font-bold text-lg mb-3 capitalize text-amber-400">{category}</h3>
                    <div className="space-y-3">
                      {books.map((book, index) => (
                        <div key={index} className="border-l-2 border-amber-500 pl-3">
                          <p className="font-medium text-white text-sm">{book.title}</p>
                          <p className="text-gray-400 text-xs mb-1">by {book.author}</p>
                          <p className="text-gray-500 text-xs leading-relaxed">{book.whyRead}</p>
                        </div>
                      ))}
                    </div>
                    <p className="text-xs text-gray-500 mt-3">{books.length} books in this category</p>
                  </div>
                ))}
              </div>

              {/* Reading Challenge */}
              <div className="bg-slate-800 rounded-xl p-6 border border-slate-700">
                <h3 className="text-lg font-bold mb-3">üìö Reading Challenge</h3>
                <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                  <div className="text-center">
                    <p className="text-2xl font-bold text-blue-400">0</p>
                    <p className="text-xs text-gray-400">Books Read</p>
                  </div>
                  <div className="text-center">
                    <p className="text-2xl font-bold text-green-400">0</p>
                    <p className="text-xs text-gray-400">Pages Read</p>
                  </div>
                  <div className="text-center">
                    <p className="text-2xl font-bold text-purple-400">0</p>
                    <p className="text-xs text-gray-400">Key Insights</p>
                  </div>
                  <div className="text-center">
                    <p className="text-2xl font-bold text-yellow-400">0</p>
                    <p className="text-xs text-gray-400">Streak (days)</p>
                  </div>
                </div>
                <button className="w-full mt-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors">
                  Log Reading Progress
                </button>
              </div>
            </div>
          </div>
        );
      }

      if (view === 'nutrition') {
        console.log('Nutrition view loaded');

        // Complete food database
        const foodDatabase = {
          proteins: [
            { name: "Chicken Breast (4oz)", calories: 165, protein: 31, carbs: 0, fat: 3.6 },
            { name: "Salmon (4oz)", calories: 206, protein: 22, carbs: 0, fat: 12 },
            { name: "Greek Yogurt (plain, 6oz)", calories: 100, protein: 18, carbs: 6, fat: 0 },
            { name: "Eggs (2 large)", calories: 143, protein: 13, carbs: 1, fat: 10 },
            { name: "Tuna (canned, 4oz)", calories: 100, protein: 22, carbs: 0, fat: 1 },
            { name: "Turkey Breast (4oz)", calories: 135, protein: 30, carbs: 0, fat: 1 },
            { name: "Cottage Cheese (4oz)", calories: 110, protein: 13, carbs: 3, fat: 5 },
            { name: "Tofu (4oz)", calories: 94, protein: 10, carbs: 2, fat: 6 }
          ],
          carbs: [
            { name: "Brown Rice (1 cup cooked)", calories: 216, protein: 5, carbs: 44, fat: 2 },
            { name: "Sweet Potato (medium)", calories: 103, protein: 2, carbs: 24, fat: 0 },
            { name: "Oatmeal (1 cup cooked)", calories: 147, protein: 5, carbs: 27, fat: 3 },
            { name: "Quinoa (1 cup cooked)", calories: 222, protein: 8, carbs: 39, fat: 4 },
            { name: "Whole Wheat Bread (2 slices)", calories: 140, protein: 6, carbs: 24, fat: 2 },
            { name: "Banana", calories: 105, protein: 1, carbs: 27, fat: 0 },
            { name: "Apple", calories: 95, protein: 0, carbs: 25, fat: 0 },
            { name: "Avocado (1/2 medium)", calories: 120, protein: 1, carbs: 6, fat: 11 }
          ],
          vegetables: [
            { name: "Broccoli (1 cup)", calories: 31, protein: 3, carbs: 6, fat: 0 },
            { name: "Spinach (2 cups)", calories: 14, protein: 2, carbs: 2, fat: 0 },
            { name: "Mixed Greens Salad (2 cups)", calories: 20, protein: 2, carbs: 4, fat: 0 },
            { name: "Carrots (1 cup)", calories: 50, protein: 1, carbs: 12, fat: 0 },
            { name: "Bell Peppers (1 cup)", calories: 24, protein: 1, carbs: 6, fat: 0 },
            { name: "Zucchini (1 cup)", calories: 20, protein: 1, carbs: 4, fat: 1 },
            { name: "Tomatoes (1 medium)", calories: 22, protein: 1, carbs: 5, fat: 0 },
            { name: "Cucumber (1 cup)", calories: 16, protein: 1, carbs: 4, fat: 0 }
          ],
          snacks: [
            { name: "Almonds (1oz)", calories: 164, protein: 6, carbs: 6, fat: 14 },
            { name: "Greek Yogurt with Berries", calories: 150, protein: 20, carbs: 15, fat: 2 },
            { name: "Apple with Peanut Butter", calories: 200, protein: 5, carbs: 25, fat: 10 },
            { name: "Protein Bar", calories: 200, protein: 20, carbs: 20, fat: 5 },
            { name: "Mixed Nuts (1oz)", calories: 175, protein: 5, carbs: 6, fat: 16 },
            { name: "Dark Chocolate (1oz)", calories: 170, protein: 2, carbs: 13, fat: 12 },
            { name: "Trail Mix (1oz)", calories: 140, protein: 4, carbs: 12, fat: 9 },
            { name: "Jerky (1oz)", calories: 116, protein: 9, carbs: 3, fat: 7 }
          ]
        };

        // State management (already declared at component level)

        const todayKey = getTodayLocal();
        const todaysMeals = nutritionData[todayKey] || {
          breakfast: [], lunch: [], dinner: [], snacks: []
        };

        // Calculate daily totals
        const calculateTotals = () => {
          const allFoods = Object.values(todaysMeals).flat();
          return allFoods.reduce((totals, food) => ({
            calories: totals.calories + (food.calories || 0),
            protein: totals.protein + (food.protein || 0),
            carbs: totals.carbs + (food.carbs || 0),
            fat: totals.fat + (food.fat || 0)
          }), { calories: 0, protein: 0, carbs: 0, fat: 0 });
        };

        const dailyTotals = calculateTotals();

        const addFood = (food) => {
          const updatedMeals = {
            ...todaysMeals,
            [selectedMeal]: [...todaysMeals[selectedMeal], food]
          };
          const updatedNutrition = {
            ...nutritionData,
            [todayKey]: updatedMeals
          };
          setNutritionData(updatedNutrition);
          localStorage.setItem('vita-nutrition', JSON.stringify(updatedNutrition));
          setShowAddFood(false);
        };

        const removeFood = (mealType, index) => {
          const updatedMeals = {
            ...todaysMeals,
            [mealType]: todaysMeals[mealType].filter((_, i) => i !== index)
          };
          const updatedNutrition = {
            ...nutritionData,
            [todayKey]: updatedMeals
          };
          setNutritionData(updatedNutrition);
          localStorage.setItem('vita-nutrition', JSON.stringify(updatedNutrition));
        };

        // Load nutrition data on component mount
        useEffect(() => {
          const saved = localStorage.getItem('vita-nutrition');
          if (saved) {
            try {
              setNutritionData(JSON.parse(saved));
            } catch (e) {
              console.error('Error loading nutrition data:', e);
            }
          }
        }, []);

        return (
          <div className="min-h-screen p-4">
            <div className="max-w-4xl mx-auto">
              <h1 className="text-4xl font-bold mb-4 text-center">Vita</h1>

              <div className="flex gap-2 justify-center mb-6 flex-wrap">
                <button onClick={() => setView('today')} className="px-3 py-2 bg-slate-700 text-gray-300 rounded-lg text-xs">Today</button>
                <button onClick={() => setView('progress')} className="px-3 py-2 bg-slate-700 text-gray-300 rounded-lg text-xs">Progress</button>
                <button onClick={() => setView('workouts')} className="px-3 py-2 bg-slate-700 text-gray-300 rounded-lg text-xs">Workouts</button>
                <button onClick={() => setView('affirmations')} className="px-3 py-2 bg-slate-700 text-gray-300 rounded-lg text-xs">Affirmations</button>
                <button onClick={() => setView('coach')} className="px-3 py-2 bg-slate-700 text-gray-300 rounded-lg text-xs">Coach</button>
                <button onClick={() => setView('books')} className="px-3 py-2 bg-slate-700 text-gray-300 rounded-lg text-xs">Books</button>
                <button onClick={() => setView('nutrition')} className="px-3 py-2 bg-amber-600 text-white rounded-lg text-xs">Nutrition</button>
              </div>

              {/* Daily Totals */}
              <div className="bg-slate-800 rounded-xl p-6 mb-6 border border-slate-700">
                <h2 className="text-xl font-bold mb-4 text-center">Today's Nutrition</h2>
                <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                  <div className="text-center">
                    <p className="text-2xl font-bold text-orange-400">{dailyTotals.calories}</p>
                    <p className="text-xs text-gray-400">Calories</p>
                  </div>
                  <div className="text-center">
                    <p className="text-2xl font-bold text-blue-400">{dailyTotals.protein}g</p>
                    <p className="text-xs text-gray-400">Protein</p>
                  </div>
                  <div className="text-center">
                    <p className="text-2xl font-bold text-green-400">{dailyTotals.carbs}g</p>
                    <p className="text-xs text-gray-400">Carbs</p>
                  </div>
                  <div className="text-center">
                    <p className="text-2xl font-bold text-purple-400">{dailyTotals.fat}g</p>
                    <p className="text-xs text-gray-400">Fat</p>
                  </div>
                </div>
                <div className="text-center">
                  <button
                    onClick={() => setShowAddFood(true)}
                    className="px-6 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors"
                  >
                    + Add Food
                  </button>
                </div>
              </div>

              {/* Meal Sections */}
              <div className="space-y-4 mb-6">
                {['breakfast', 'lunch', 'dinner', 'snacks'].map(mealType => (
                  <div key={mealType} className="bg-slate-800 rounded-xl p-4 border border-slate-700">
                    <div className="flex justify-between items-center mb-3">
                      <h3 className="font-bold capitalize text-amber-400">{mealType}</h3>
                      <span className="text-sm text-gray-400">
                        {todaysMeals[mealType].reduce((sum, food) => sum + (food.calories || 0), 0)} cal
                      </span>
                    </div>
                    {todaysMeals[mealType].length === 0 ? (
                      <p className="text-gray-500 text-sm italic">No foods logged yet</p>
                    ) : (
                      <div className="space-y-2">
                        {todaysMeals[mealType].map((food, index) => (
                          <div key={index} className="flex justify-between items-center bg-slate-700 rounded p-2">
                            <div>
                              <p className="font-medium text-sm">{food.name}</p>
                              <p className="text-xs text-gray-400">
                                {food.calories} cal ‚Ä¢ P:{food.protein}g ‚Ä¢ C:{food.carbs}g ‚Ä¢ F:{food.fat}g
                              </p>
                            </div>
                            <button
                              onClick={() => removeFood(mealType, index)}
                              className="text-red-400 hover:text-red-300 text-sm"
                            >
                              ‚úï
                            </button>
                          </div>
                        ))}
                      </div>
                    )}
                  </div>
                ))}
              </div>

              {/* Add Food Modal */}
              {showAddFood && (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                  <div className="bg-slate-800 rounded-xl p-6 w-full max-w-md border border-slate-700 max-h-96 overflow-y-auto">
                    <div className="flex justify-between items-center mb-4">
                      <h3 className="text-lg font-bold">Add Food</h3>
                      <button
                        onClick={() => setShowAddFood(false)}
                        className="text-gray-400 hover:text-white"
                      >
                        ‚úï
                      </button>
                    </div>

                    <div className="mb-4">
                      <label className="block text-sm font-medium mb-2">Meal Type</label>
                      <select
                        value={selectedMeal}
                        onChange={(e) => setSelectedMeal(e.target.value)}
                        className="w-full p-2 bg-slate-700 rounded text-white"
                      >
                        <option value="breakfast">Breakfast</option>
                        <option value="lunch">Lunch</option>
                        <option value="dinner">Dinner</option>
                        <option value="snacks">Snacks</option>
                      </select>
                    </div>

                    <div className="space-y-4">
                      {Object.entries(foodDatabase).map(([category, foods]) => (
                        <div key={category}>
                          <h4 className="font-medium capitalize mb-2 text-amber-400">{category}</h4>
                          <div className="space-y-1">
                            {foods.map((food, index) => (
                              <button
                                key={index}
                                onClick={() => addFood(food)}
                                className="w-full text-left p-2 bg-slate-700 rounded hover:bg-slate-600 transition-colors"
                              >
                                <div className="flex justify-between">
                                  <span className="text-sm font-medium">{food.name}</span>
                                  <span className="text-sm text-amber-400">{food.calories} cal</span>
                                </div>
                                <div className="text-xs text-gray-400 mt-1">
                                  P:{food.protein}g ‚Ä¢ C:{food.carbs}g ‚Ä¢ F:{food.fat}g
                                </div>
                              </button>
                            ))}
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                </div>
              )}

              {/* Nutrition Goals */}
              <div className="bg-slate-800 rounded-xl p-6 border border-slate-700">
                <h3 className="text-lg font-bold mb-4">üéØ Nutrition Goals</h3>
                <div className="space-y-3">
                  <div className="flex justify-between items-center">
                    <span>Calories</span>
                    <span className={dailyTotals.calories > 2000 ? 'text-red-400' : dailyTotals.calories > 1500 ? 'text-yellow-400' : 'text-green-400'}>
                      {dailyTotals.calories}/2000
                    </span>
                  </div>
                  <div className="w-full bg-slate-700 rounded-full h-2">
                    <div
                      className="bg-green-500 h-2 rounded-full"
                      style={{ width: `${Math.min((dailyTotals.calories / 2000) * 100, 100)}%` }}
                    ></div>
                  </div>

                  <div className="flex justify-between items-center">
                    <span>Protein</span>
                    <span className={dailyTotals.protein > 150 ? 'text-red-400' : dailyTotals.protein > 100 ? 'text-yellow-400' : 'text-green-400'}>
                      {dailyTotals.protein}g/150g
                    </span>
                  </div>
                  <div className="w-full bg-slate-700 rounded-full h-2">
                    <div
                      className="bg-blue-500 h-2 rounded-full"
                      style={{ width: `${Math.min((dailyTotals.protein / 150) * 100, 100)}%` }}
                    ></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        );
      }

      if (view === 'progress') {
        const rate = history.length > 0 ? Math.round((history.reduce((s, d) => s + d.done.length, 0) / (history.length * 18)) * 100) : 0;
        return (
          <div className="min-h-screen p-4">
            <div className="max-w-4xl mx-auto">
              <h1 className="text-4xl font-bold mb-4 text-center">Vita</h1>
              <div className="flex gap-2 justify-center mb-6">
                <button onClick={() => setView('today')} className="px-6 py-2 bg-slate-700 rounded-lg">Today</button>
                <button onClick={() => setView('progress')} className="px-6 py-2 bg-amber-600 text-white rounded-lg">Progress</button>
                <button onClick={() => setView('workouts')} className="px-6 py-2 bg-slate-700 rounded-lg">Workouts</button>
              </div>
              <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                <div className="bg-slate-800 rounded-xl p-6 border border-slate-700">
                  <p className="text-sm mb-2">Completion</p>
                  <p className="text-4xl font-bold">{rate}%</p>
                  <p className="text-xs text-gray-400">avg across all days</p>
                </div>
                <div className="bg-slate-800 rounded-xl p-6 border border-slate-700">
                  <p className="text-sm mb-2">Days</p>
                  <p className="text-4xl font-bold">{history.length}</p>
                  <p className="text-xs text-gray-400">total tracked</p>
                </div>
                <div className="bg-slate-800 rounded-xl p-6 border border-slate-700">
                  <p className="text-sm mb-2">Workouts</p>
                  <p className="text-4xl font-bold">{history.filter(d => d.workoutDone).length}</p>
                  <p className="text-xs text-gray-400">completed</p>
                </div>
                <div className="bg-slate-800 rounded-xl p-6 border border-slate-700">
                  <p className="text-sm mb-2">This Week</p>
                  <p className="text-4xl font-bold">{history.slice(0, 7).filter(d => d.done.length > 0).length}</p>
                  <p className="text-xs text-gray-400">active days</p>
                </div>
              </div>

              {history.length > 7 && (
                <div className="bg-slate-800 rounded-xl p-6 border border-slate-700 mb-6">
                  <h2 className="text-xl font-bold mb-4">Monthly Trends</h2>
                  <div className="space-y-2 max-h-48 overflow-y-auto">
                    {(() => {
                      const months = {};
                      history.forEach(day => {
                        const date = new Date(day.date);
                        const monthKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;
                        if (!months[monthKey]) months[monthKey] = { days: 0, tasks: 0, workouts: 0 };
                        months[monthKey].days++;
                        months[monthKey].tasks += day.done.length;
                        if (day.workoutDone) months[monthKey].workouts++;
                      });

                      return Object.entries(months)
                        .sort(([a], [b]) => b.localeCompare(a))
                        .slice(0, 6)
                        .map(([month, stats]) => ({
                          month: new Date(month + '-01').toLocaleDateString('en-US', { month: 'short', year: '2-digit' }),
                          avgTasks: Math.round((stats.tasks / stats.days) || 0),
                          workoutRate: Math.round((stats.workouts / stats.days) * 100) || 0
                        }))
                        .map(stat => (
                          <div key={stat.month} className="flex justify-between items-center bg-slate-700 rounded p-2">
                            <span className="font-medium">{stat.month}</span>
                            <div className="flex gap-4 text-sm">
                              <span>Tasks: <span className="text-amber-400">{stat.avgTasks}/18</span></span>
                              <span>Workouts: <span className="text-green-400">{stat.workoutRate}%</span></span>
                            </div>
                          </div>
                        ));
                    })()}
                  </div>
                </div>
              )}

              <div className="bg-slate-800 rounded-xl p-6 border border-slate-700 mb-6">
                <div className="flex justify-between items-center mb-4">
                  <h2 className="text-xl font-bold">
                    {showAllHistory ? `All History (${history.length} days)` : 'Last 7 Days'}
                  </h2>
                  {history.length > 7 && (
                    <button
                      onClick={() => setShowAllHistory(!showAllHistory)}
                      className="px-4 py-2 bg-slate-700 rounded-lg text-sm hover:bg-slate-600 transition-colors"
                    >
                      {showAllHistory ? 'Show Recent' : `Show All (${history.length})`}
                    </button>
                  )}
                </div>
                {(showAllHistory ? history : history.slice(0, 7)).map(d => {
                  const pct = Math.round((d.done.length / 18) * 100);
                  const daysAgo = Math.floor((new Date() - new Date(d.date)) / (1000 * 60 * 60 * 24));
                  const isToday = daysAgo === 0;
                  const isYesterday = daysAgo === 1;

                  return (
                    <div key={d.date} className="bg-slate-700 rounded-lg p-4 mb-3 cursor-pointer hover:bg-slate-600 transition-colors" onClick={() => setViewingDay(d)}>
                      <div className="flex justify-between mb-2">
                        <div className="flex items-center gap-2">
                          <span className="font-medium">
                            {isToday ? 'Today' :
                             isYesterday ? 'Yesterday' :
                             new Date(d.date).toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' })}
                          </span>
                          {daysAgo > 1 && <span className="text-xs text-gray-500">({daysAgo} days ago)</span>}
                        </div>
                        <div className="flex items-center gap-2">
                          {d.workoutDone && <span className="text-green-400 text-sm">üí™</span>}
                          <span className="text-amber-400 font-bold">{pct}%</span>
                        </div>
                      </div>
                      <div className="w-full bg-slate-600 rounded-full h-2 mb-2">
                        <div className="bg-amber-500 h-2 rounded-full" style={{ width: `${pct}%` }} />
                      </div>
                      <div className="text-xs text-gray-400">
                        {d.done.length}/18 tasks ‚Ä¢ {d.workoutDone ? `Workout: ${d.workoutType || 'Completed'}` : 'No workout'}
                        {d.journal && <span className="ml-2">üìù</span>}
                      </div>
                    </div>
                  );
                })}
                {history.length === 0 && (
                  <div className="text-center py-8 text-gray-500">
                    <p className="text-lg mb-2">No history yet</p>
                    <p className="text-sm">Complete some tasks and they'll appear here!</p>
                  </div>
                )}
              </div>

              {viewingDay && (
                <div className="bg-slate-800 rounded-xl p-6 border border-slate-700">
                  <div className="flex justify-between items-center mb-4">
                    <h2 className="text-xl font-bold">
                      {new Date(viewingDay.date).toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' })}
                    </h2>
                    <button onClick={() => setViewingDay(null)} className="px-3 py-1 bg-slate-700 rounded text-sm hover:bg-slate-600">‚úï</button>
                  </div>

                  <div className="grid grid-cols-2 gap-4 mb-6">
                    <div className="bg-slate-700 rounded-lg p-4">
                      <p className="text-sm text-gray-400 mb-1">Tasks Completed</p>
                      <p className="text-2xl font-bold text-amber-400">{viewingDay.done.length}/18</p>
                      <p className="text-sm text-gray-300">{Math.round((viewingDay.done.length / 18) * 100)}% complete</p>
                    </div>
                    <div className="bg-slate-700 rounded-lg p-4">
                      <p className="text-sm text-gray-400 mb-1">Workout</p>
                      <p className="text-lg font-bold text-green-400">
                        {viewingDay.workoutDone ? (viewingDay.workoutType ? labels[viewingDay.workoutType] || viewingDay.workoutType : 'Completed') : 'Not completed'}
                      </p>
                      {viewingDay.miles && <p className="text-sm text-gray-300">{viewingDay.miles} miles run</p>}

                      {viewingDay.workoutDone && viewingDay.weights && Object.keys(viewingDay.weights).length > 0 && (
                        <div className="mt-3">
                          <p className="text-xs text-gray-400 mb-2">Exercises Completed:</p>
                          <div className="space-y-1">
                            {Object.entries(viewingDay.weights).map(([exercise, weight]) => (
                              <div key={exercise} className="flex justify-between text-sm">
                                <span className="text-gray-300">{exercise}:</span>
                                <span className="text-amber-400 font-medium">{weight} lbs</span>
                              </div>
                            ))}
                          </div>
                        </div>
                      )}
                    </div>
                  </div>

                  <div className="mb-6">
                    <h3 className="font-bold mb-3">Completed Tasks</h3>
                    <div className="space-y-2">
                      {tasks.core.map(t => (
                        <div key={t.id} className={`p-2 rounded text-sm ${viewingDay.done.includes(t.id) ? 'bg-green-900 border border-green-600' : 'bg-slate-700 opacity-50'}`}>
                          <span>{viewingDay.done.includes(t.id) ? '‚úÖ' : '‚¨ú'}</span> {t.t}
                        </div>
                      ))}
                      {tasks.lead.map(t => (
                        <div key={t.id} className={`p-2 rounded text-sm ${viewingDay.done.includes(t.id) ? 'bg-amber-900 border border-amber-600' : 'bg-slate-700 opacity-50'}`}>
                          <span>{viewingDay.done.includes(t.id) ? '‚úÖ' : '‚¨ú'}</span> {t.t}
                        </div>
                      ))}
                      {tasks.comm.map(t => (
                        <div key={t.id} className={`p-2 rounded text-sm ${viewingDay.done.includes(t.id) ? 'bg-purple-900 border border-purple-600' : 'bg-slate-700 opacity-50'}`}>
                          <span>{viewingDay.done.includes(t.id) ? '‚úÖ' : '‚¨ú'}</span> {t.t}
                        </div>
                      ))}
                    </div>
                  </div>

                  {viewingDay.journal && (
                    <div className="mb-4">
                      <h3 className="font-bold mb-2">Reflection</h3>
                      <div className="bg-slate-700 rounded p-3 text-sm text-gray-300">
                        {viewingDay.journal}
                      </div>
                    </div>
                  )}

                  <div className="grid grid-cols-3 gap-4 text-center">
                    {viewingDay.mood && (
                      <div className="bg-slate-700 rounded p-3">
                        <p className="text-xs text-gray-400 mb-1">Mood</p>
                        <p className="text-lg">{viewingDay.mood}</p>
                      </div>
                    )}
                    {viewingDay.water && (
                      <div className="bg-slate-700 rounded p-3">
                        <p className="text-xs text-gray-400 mb-1">Water</p>
                        <p className="text-lg">{viewingDay.water} glasses</p>
                      </div>
                    )}
                    {viewingDay.deepWork && (
                      <div className="bg-slate-700 rounded p-3">
                        <p className="text-xs text-gray-400 mb-1">Deep Work</p>
                        <p className="text-lg">{viewingDay.deepWork} hrs</p>
                      </div>
                    )}
                  </div>
                </div>
              )}
            </div>
          </div>
        );
      }

      const total = 18;
      const done = data.done ? data.done.length : 0;

      return (
        <div className="min-h-screen p-4">
          <div className="max-w-4xl mx-auto">
            <div className="flex items-center justify-between mb-2">
              <div className="flex-1">
                <h1 className="text-4xl font-bold mb-1">Vita</h1>
                <p className="text-sm text-gray-400">{new Date().toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' })}</p>
              </div>
              <div className="flex items-center gap-2">
                <div className={`px-3 py-1 rounded-full text-sm ${isExisting ? 'bg-green-700 text-white' : 'bg-slate-700 text-gray-200'}`}>
                  {isExisting ? 'Existing' : 'Fresh'}
                </div>
                <button onClick={startNewDay} className="px-3 py-2 bg-slate-700 rounded text-sm">New Day</button>
              </div>
            </div>

            {saveStatus && <p className="text-center text-sm text-green-400 mb-2">{saveStatus}</p>}

            <div className="flex gap-2 justify-center mb-6 flex-wrap">
              <button onClick={() => setView('today')} className="px-3 py-2 bg-amber-600 text-white rounded-lg text-xs">Today</button>
              <button onClick={() => setView('progress')} className="px-3 py-2 bg-slate-700 text-gray-300 rounded-lg text-xs">Progress</button>
              <button onClick={() => setView('workouts')} className="px-3 py-2 bg-slate-700 text-gray-300 rounded-lg text-xs">Workouts</button>
              <button onClick={() => setView('affirmations')} className="px-3 py-2 bg-slate-700 text-gray-300 rounded-lg text-xs">Affirmations</button>
              <button onClick={() => setView('coach')} className="px-3 py-2 bg-slate-700 text-gray-300 rounded-lg text-xs">Coach</button>
              <button onClick={() => setView('books')} className="px-3 py-2 bg-slate-700 text-gray-300 rounded-lg text-xs">Books</button>
              <button onClick={() => setView('nutrition')} className="px-3 py-2 bg-slate-700 text-gray-300 rounded-lg text-xs">Nutrition</button>
            </div>

            <div className="bg-slate-800 rounded-xl p-6 mb-6 border border-slate-700">
              <div className="flex justify-between mb-3">
                <span>Progress</span>
                <span className="text-2xl font-bold text-amber-400">{done}/{total}</span>
              </div>
              <div className="w-full bg-slate-700 rounded-full h-3">
                <div className="bg-amber-500 h-3 rounded-full" style={{ width: `${(done/total)*100}%` }} />
              </div>
            </div>

            <div className="bg-slate-800 rounded-xl p-6 mb-6 border border-slate-700">
              <h3 className="mb-3">Mood</h3>
              <div className="flex gap-2 flex-wrap">
                {['üòä Sharp', 'üôÇ Good', 'üòê Okay', 'üòî Off', 'üò∞ Hard'].map(m => (
                  <button key={m} onClick={async () => { const nd = { ...data, mood: m }; const cleanData = JSON.parse(JSON.stringify(nd)); setData(cleanData); await save(cleanData); }} className={`px-4 py-2 rounded-lg ${data.mood === m ? 'bg-amber-500 text-white' : 'bg-slate-700 text-gray-300'}`}>
                    {m}
                  </button>
                ))}
              </div>
            </div>

            <div className="bg-slate-800 rounded-xl p-6 mb-6 border border-slate-700">
              <div className="flex justify-between items-center mb-3">
                <div className="flex items-center gap-2">üíß<span className="ml-1">Water Intake</span></div>
                <span className="text-xl font-bold text-blue-400">{water} glasses</span>
              </div>
              <div className="flex gap-2">
                <button onClick={() => updateWater(-1)} className="px-6 py-2 bg-slate-700 text-white rounded-lg font-bold">-</button>
                <button onClick={() => updateWater(1)} className="flex-1 py-2 bg-blue-600 text-white rounded-lg font-bold">+ Glass</button>
              </div>
              <p className="text-xs text-gray-400 mt-2">Target: 8 glasses per day (64oz)</p>
            </div>

            <div className="bg-slate-800 rounded-xl p-6 mb-6 border border-slate-700">
              <div className="flex items-center gap-2 mb-3">üíª<span>SaaS Work</span></div>
              <textarea value={saas} onChange={e => setSaas(e.target.value)} onBlur={async () => { const nd = { ...data, saas }; const cleanData = JSON.parse(JSON.stringify(nd)); setData(cleanData); await save(cleanData); }} placeholder="What did you work on today?" className="w-full p-3 bg-slate-700 rounded text-white mb-3" rows="3" />
              <div className="grid grid-cols-2 gap-3 mb-3">
                <input type="number" step="0.5" value={deepWork} onChange={e => setDeepWork(e.target.value)} onBlur={async () => { const nd = { ...data, deepWork }; const cleanData = JSON.parse(JSON.stringify(nd)); setData(cleanData); await save(cleanData); }} placeholder="Deep work (hrs)" className="p-3 bg-slate-700 rounded text-white" />
                <input type="number" value={talks} onChange={e => setTalks(e.target.value)} onBlur={async () => { const nd = { ...data, talks }; const cleanData = JSON.parse(JSON.stringify(nd)); setData(cleanData); await save(cleanData); }} placeholder="User talks" className="p-3 bg-slate-700 rounded text-white" />
              </div>
              <button onClick={async () => { const nd = { ...data, saas, deepWork, talks }; const cleanData = JSON.parse(JSON.stringify(nd)); setData(cleanData); await save(cleanData); setSaveStatus('SaaS work saved! ‚úì'); setTimeout(() => setSaveStatus(''), 2000); }} className="w-full py-2 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors">
                Save SaaS Work
              </button>
            </div>

            <div className="bg-slate-800 rounded-xl p-6 mb-6 border border-slate-700">
              <h3 className="mb-3">Non-Negotiables</h3>
              {tasks.core.map(t => (
                <div key={t.id} onClick={() => toggle(t.id)} className={`p-3 rounded-lg mb-2 cursor-pointer ${data.done.includes(t.id) ? 'bg-green-900 border-2 border-green-500' : 'bg-slate-700'}`}>
                  <div className="flex items-center justify-between">
                    <span className="text-sm">{t.t}</span>
                    {data.done.includes(t.id) && <span>‚úÖ</span>}
                  </div>
                </div>
              ))}
            </div>

            <div className="bg-slate-800 rounded-xl p-6 mb-6 border border-slate-700">
              <h3 className="mb-3">Leadership (Do 1+)</h3>
              {tasks.lead.map(t => (
                <div key={t.id} onClick={() => toggle(t.id)} className={`p-3 rounded-lg mb-2 cursor-pointer ${data.done.includes(t.id) ? 'bg-amber-900 border-2 border-amber-500' : 'bg-slate-700'}`}>
                  <div className="flex items-center justify-between">
                    <span className="text-sm">{t.t}</span>
                    {data.done.includes(t.id) && <span>‚úÖ</span>}
                  </div>
                </div>
              ))}
            </div>

            <div className="bg-slate-800 rounded-xl p-6 mb-6 border border-slate-700">
              <h3 className="mb-3">Communication</h3>
              {tasks.comm.map(t => (
                <div key={t.id} onClick={() => toggle(t.id)} className={`p-3 rounded-lg mb-2 cursor-pointer ${data.done.includes(t.id) ? 'bg-purple-900 border-2 border-purple-500' : 'bg-slate-700'}`}>
                  <div className="flex items-center justify-between">
                    <span className="text-sm">{t.t}</span>
                    {data.done.includes(t.id) && <span>‚úÖ</span>}
                  </div>
                </div>
              ))}
            </div>

            <div className="bg-slate-800 rounded-xl p-6 border border-slate-700">
              <div className="flex items-center gap-2 mb-3">üìö<span>Reflection</span></div>
              <textarea value={journal} onChange={e => setJournal(e.target.value)} onBlur={async () => { const nd = { ...data, journal }; const cleanData = JSON.parse(JSON.stringify(nd)); setData(cleanData); await save(cleanData); }} placeholder="What did I lead? What did I ship? How did I grow?" className="w-full p-3 bg-slate-700 rounded text-white mb-3" rows="4" />
              <button onClick={async () => { const nd = { ...data, journal }; const cleanData = JSON.parse(JSON.stringify(nd)); setData(cleanData); await save(cleanData); setSaveStatus('Reflection saved! ‚úì'); setTimeout(() => setSaveStatus(''), 2000); }} className="w-full py-2 bg-amber-600 text-white rounded-lg font-semibold hover:bg-amber-700 transition-colors">
                Save Reflection
              </button>
            </div>

          </div>
        </div>
      );
    }

    ReactDOM.render(<VitaApp />, document.getElementById('root'));
  </script>

</body>
</html>
